
Для создания образа с флешки с помощью команды `dd`, выполните следующие шаги:
### Шаг 1. Определите имя устройства флешки

>1 Подключите флешку к компьютеру, выполните команду, чтобы увидеть список подключенных устройств:
```bash
lsblk
```

>Вы увидите список устройств. Например:
```
NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
sda 8:0 0 500G 0 disk
├─sda1 8:1 0 100G 0 part /
└─sda2 8:2 0 400G 0 part /data
sdb 8:16 1 16G 0 disk
└─sdb1 8:17 1 16G 0 part /media/usb
```
  - Здесь флешка — это устройство `sdb`.
### Шаг 2. Отмонтируйте флешку

Если флешка смонтирована (например, `/media/usb`), отмонтируйте её:

```bash
sudo umount /dev/sdb1
```
- Отмонтируйте все разделы флешки, если их несколько.

### Шаг 3. Создайте образ флешки

>[!Warning]  Убедитесь, что вы указали правильное устройство (`/dev/sdb`). Использование неправильного устройства может повредить данные.

>Запустите команду `dd`, указав исходное устройство (флешка) и путь для сохранения образа:
```bash
sudo dd if=/dev/sdb of=/path/to/image.iso bs=4M status=progress
```

- **`if=/dev/sdb`** — входной файл, в данном случае ваша флешка.
- **`of=/path/to/image.iso`** — выходной файл, куда будет сохранён образ (например, `/home/user/flash_image.iso`).
- **`bs=4M`** — размер блока, оптимизирует скорость копирования (4 MB).
- **`status=progress`** — показывает прогресс выполнения команды.

### Шаг 4. Убедитесь, что образ создан

>После завершения команды проверьте созданный файл:
```bash
ls -lh /path/to/image.iso
```

> Если нужно сжать образ, можно воспользоваться `gzip`:
```bash
sudo dd if=/dev/sdb bs=4M | gzip > /path/to/image.gz
```

### Шаг 5. Восстановите данные на другую флешку

Если вам нужно записать образ на новую флешку, выполните следующие действия:

1. Определите имя устройства для новой флешки аналогично Шагу 1.
2. Убедитесь, что новая флешка отмонтирована, как указано в Шаге 2.
3. Выполните команду для записи образа на флешку:
```bash
sudo dd if=/path/to/image.iso of=/dev/sdX bs=4M status=progress
```

- **if=/path/to/image.iso** — путь к ранее созданному образу.
- **of=/dev/sdX** — устройство вашей новой флешки (например, `/dev/sdc`).
- **bs=4M** — размер блока.
- **status=progress** — показывает прогресс выполнения команды.

>[!Warning]   **Важно**: Убедитесь, что указали правильное устройство, так как данные на целевом устройстве будут уничтожены.

### Шаг 6. Увеличьте размер раздела

После восстановления данных, если новая флешка больше по размеру, чем исходная, можно увеличить раздел, чтобы использовать всё доступное пространство:

1. Убедитесь, что флешка не смонтирована.
2. Запустите утилиту `fdisk` для работы с разделами:
```bash
sudo fdisk /dev/sdX
```
3. Внутри `fdisk` выполните следующие действия:
    
    - Нажмите **`p`**, чтобы увидеть таблицу разделов.
    - Нажмите **`d`**, чтобы удалить существующий раздел.
    - Нажмите **`n`**, чтобы создать новый раздел, охватывающий весь доступный объём.
    - Нажмите **`w`**, чтобы сохранить изменения и выйти.
4. Обновите файловую систему для нового размера раздела:
```bash
sudo e2fsck -f /dev/sdX1
sudo resize2fs /dev/sdX1
```
# VPS Security Audit Script

[–ò—Å—Ç–æ—á–Ω–∏–∫](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#vps-security-audit-script)

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ Bash –¥–ª—è –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ VPS (–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞). –≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é.

[![Sample Output](https://github.com/Acenotass/vps-audit/raw/main/screenshot.png)](https://github.com/Acenotass/vps-audit/blob/main/screenshot.png)

## Features

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH
    - –°—Ç–∞—Ç—É—Å –≤—Ö–æ–¥–∞ –ø–æ–¥ —Ä—É—Ç–æ–º
    - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –ø–∞—Ä–æ–ª—é
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
- –°—Ç–∞—Ç—É—Å —Ñ–∞–π—Ä–≤–æ–ª–∞ (UFW)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Fail2ban
- –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É
- –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã
- –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–ª—É–∂–±
- –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è sudo
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª–µ–π
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ SUID

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (CPU)
- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Ubuntu/Debian-based Linux system
- Root access or sudo privileges
- Basic packages (most are pre-installed):
    - ufw
    - systemd
    - netstat
    - grep
    - awk

## Installation

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#installation)

1. Download the script:

```shell
wget https://raw.githubusercontent.com/vernu/vps-audit/main/vps-audit.sh
# or
curl -O https://raw.githubusercontent.com/vernu/vps-audit/main/vps-audit.sh
```

2. Make the script executable:

```shell
chmod +x vps-audit.sh
```

## Usage

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#usage)

Run the script with sudo privileges:

```shell
sudo ./vps-audit.sh
```

The script will:

1. Perform all security checks
2. Display results in real-time with color coding:
    - üü¢ [PASS] - Check passed successfully
    - üü° [WARN] - Potential issues detected
    - üî¥ [FAIL] - Critical issues found
3. Generate a detailed report file: `vps-audit-report-[TIMESTAMP].txt`

## Output Format

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#output-format)

The script provides two types of output:

1. Real-time console output with color coding:

```
[PASS] SSH Root Login - Root login is properly disabled in SSH configuration
[WARN] SSH Port - Using default port 22 - consider changing to a non-standard port
[FAIL] Firewall Status - UFW firewall is not active - your system is exposed
```

2. A detailed report file containing:
    - All check results
    - Specific recommendations for failed checks
    - System resource usage statistics
    - Timestamp of the audit

## Thresholds

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#thresholds)

### Resource Usage Thresholds

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#resource-usage-thresholds)

- PASS: < 50% usage
- WARN: 50-80% usage
- FAIL: > 80% usage

### Security Thresholds

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#security-thresholds)

- Failed Logins:
    - PASS: < 10 attempts
    - WARN: 10-50 attempts
    - FAIL: > 50 attempts
- Running Services:
    - PASS: < 20 services
    - WARN: 20-40 services
    - FAIL: > 40 services
- Open Ports:
    - PASS: < 10 ports
    - WARN: 10-20 ports
    - FAIL: > 20 ports

## Customization

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#customization)

You can modify the thresholds by editing the following variables in the script:

- Resource usage thresholds
- Failed login attempt thresholds
- Service count thresholds
- Open port thresholds

## Best Practices

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#best-practices)

1. Run the audit regularly (e.g., weekly) to maintain security
2. Review the generated report thoroughly
3. Address any FAIL status immediately
4. Investigate WARN status during maintenance
5. Keep the script updated with your security policies

## Limitations

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#limitations)

- Designed for Debian/Ubuntu-based systems
- Requires root/sudo access
- Some checks may need customization for specific environments
- Not a replacement for professional security audit

## Contributing

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#contributing)

Feel free to submit issues and enhancement requests!

## License

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#license)

This project is licensed under the MIT License - see the LICENSE file for details.

## Security Notice

[](https://github.com/Acenotass/vps-audit?tab=readme-ov-file#security-notice)

While this script helps identify common security issues, it should not be your only security measure. Always:

- Keep your system updated
- Monitor logs regularly
- Follow security best practices
- Consider professional security audits for critical systems